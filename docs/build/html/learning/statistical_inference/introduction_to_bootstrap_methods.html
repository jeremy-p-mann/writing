
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example &#8212; Jeremy Mann&#39;s Writing 0.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Statistical Learning" href="../statistical_learning/statistical_learning_main_page.html" />
    <link rel="prev" title="Statistical Inference" href="statistical_inference_main_page.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1><center><p>The Bootstrap</p>
</center></h1><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt
import numpy as np
from scipy import stats
</pre></div>
</div>
<div class="section" id="example">
<h1>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h1>
<p><em>The following story is fictional and does not depict any actual person
or event.</em></p>
<p>Let’s say that drug A has passed all testing and has been out long
enough for companies to start getting generic drugs to come out.
Although the generic drug company knows the active ingredients, it
doesn’t know how to “package” or produce that ingredient. After they
feel they have figured it out, they need to demonstrate to regulators
that their generic is “bioequivalent” to the brand name. Here,
bioequivalent is about primarily about bioavailibility, not efficacy.</p>
<p>This is usually accomplished using confidence intervals (CI).</p>
</div>
<div class="section" id="pop-quiz">
<h1>POP QUIZ<a class="headerlink" href="#pop-quiz" title="Permalink to this headline">¶</a></h1>
<p>Give two-sided 95% confidence intervals for the : * Height of male US
citizens between ages of 30-40 in 2008 (in feet) * Height of female US
citizens between ages of 30-40 in 2008 (in feet)</p>
<p>Answers:</p>
<ul class="simple">
<li><p>~ 5’3“-6’3”</p></li>
<li><p>~ 4’11” - 5’10”</p></li>
</ul>
<p>In some cases, this is done by showing that the CIs for some
biologically relevant features (usually about concentrations in various
parts of the body) for the generic are within a small “neighborhood”
(<span class="math notranslate nohighlight">\(\pm 20\)</span>%) of the CIs for the branded drug.</p>
<p>Note that we are “testing a hypothesis”, although it’s not immediately
clearly that this is a “hypothesis test”.</p>
<div class="figure align-default" id="id9">
<img alt="title" src="learning/statistical_inference/Bio_equivalent_figure.jpg" />
<p class="caption"><span class="caption-text">title</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>For biological/probabilistic reasons, scientists can choose features
which are log-normally distributed. This follows from a multiplicative
form of the CLT, “Gilbrat’s Law” reflecting the fact that these
variables arise from a large number of accumulations of small percent
changes.</p>
<p>In this case, we can choose our test statistic amenable to parametric
methods, i.e. we have an approximate formula.</p>
<p>But what if we were coerced to examine a test statistic that didn’t have
such a nice analytic description?</p>
<p>This talk will go through how to do this without “making assumptions”
about the form of distributions of the hypothesis (i.e. which parametric
family it falls in). Instead of referencing tables, we will directly use
our data.</p>
<p>In some some sense we are making “no assumptions”, <em>other than that our
data is sufficiently representative of what we are studying</em></p>
<p>Here’s the</p>
</div>
<div class="section" id="basic-idea">
<h1>Basic Idea:<a class="headerlink" href="#basic-idea" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Get sample data</p></li>
<li><p>Simulate randomness of the sampling process by creating “bootstrap”
samples of the data</p></li>
<li><p>Compute the value of the test statistic on each bootstrap sample</p></li>
<li><p>Compute confidence interval of these values</p></li>
</ul>
</div>
<div class="section" id="the-empirical-distribution">
<h1>The Empirical Distribution<a class="headerlink" href="#the-empirical-distribution" title="Permalink to this headline">¶</a></h1>
<p>The basis of most nonparametric methods is to work (almost) exclusively
with the quantities derived from the “empirical distribution”. This is
the “probability distribution generated by the data.”</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Gi
ve
n
in
de
pe
nd
en
t
da
ta
:m
at
h:
<a href="#id1"><span class="problematic" id="id2">`</span></a>X</p>
<blockquote>
<div></div></blockquote>
<p><a href="#id10"><span class="problematic" id="id11">x_</span></a>
1,</p>
<blockquote>
<div><p></p>
</div></blockquote>
<p>ld
ot
s,</p>
<blockquote>
<div><p>x</p>
</div></blockquote>
<p>_n
)`
an
d
a
pr
ob
ab
il
it
y
di
st
ri
bu
ti
on
:m
at
h:
<cite>rh
o</cite>
,
re
ca
ll
th
e
li
ke
li
ho
od
of
:m
at
h:
<cite>X
`
we
re
:m
at
h:
`rh
o</cite>
tr
ue
to
be
:</p>
</td>
</tr>
<tr class="row-even"><td><p>at
h:
:</p>
<blockquote>
<div><p></p>
</div></blockquote>
<p>ma
th
ca
l{
L}
_X</p>
<blockquote>
<div><p>(</p>
</div></blockquote>
<p>r
ho
)
=
r
ho</p>
<blockquote>
<div><p>(</p>
</div></blockquote>
<ol class="upperalpha simple" start="24">
<li></li>
</ol>
<p>pr
od
_{
i
=
0}
^n</p>
<blockquote>
<div><p></p>
</div></blockquote>
<p>rh
o(
<a href="#id12"><span class="problematic" id="id13">x_</span></a>
i)</p>
<p>Th
is
qu
an
ti
fi
es
th
e
co
ns
is
te
nc
y
of
th
e
da
ta
an
d
th
e
mo
de
l.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Th
e
em
pi
ri
ca
l
di
st
ri
bu
ti
on
is
th
e
mo
de
l
th
at
is
“m
os
t
co
ns
is
te
nt
”
wi
th
th
e
da
ta</p></td>
</tr>
<tr class="row-even"><td><p>at
h:
:</p>
<blockquote>
<div><p></p>
</div></blockquote>
<p>rh
<a href="#id14"><span class="problematic" id="id15">o_</span></a>
{X
}
=
a
rg
m
ax
_{
r
ho
}
m
at
hc
al
{L
}_
X
(rh
o)</p>
</td>
</tr>
<tr class="row-odd"><td><p>He
re
,
we
ar
e
mi
ni
mi
zi
ng
th
e
li
ke
li
ho
od
of
th
e
da
ta
<a href="#id3"><span class="problematic" id="id4">*</span></a>s
ub
je
ct
to
no
co
nd
it
io
ns
<a href="#id5"><span class="problematic" id="id6">*</span></a>,
ma
ki
ng
th
is
a
“n
on
pa
ra
me
tr
ic
”
mo
de
l.</p></td>
</tr>
<tr class="row-even"><td><p>__
:m
at
h:
<cite>rh
o_
X</cite>
“r
ea
ll
y
ov
er
fi
ts
”,
st
at
in
g
th
at
un
se
en
ev
en
ts
ar
e
im
po
ss
ib
le
,
an
d
th
e
pr
ob
ab
il
it
y
of
an
ev
en
t
is
th
e
nu
mb
er
of
oc
cu
re
nc
es
of
th
e
ev
en
t
in
a
sa
mp
le
di
vi
de
d
by
th
e
si
ze
of
th
e
sa
mp
le
.</p></td>
</tr>
<tr class="row-odd"><td><p>__
As
an
as
id
e,
no
te
th
e
ex
pe
ct
at
io
n
va
lu
e
(w
it
h
re
sp
ec
t
to
th
e
em
pi
ri
ca
l
di
st
ri
bu
ti
on
)
of
an
y
ob
se
rv
ab
le
:m
at
h:
<a href="#id7"><span class="problematic" id="id8">`</span></a>ma
th
ca
l{
O}
`
is
ju
st
it
’s
sa
mp
le
av
er
ag
e.</p></td>
</tr>
<tr class="row-even"><td><p>at
h:
:</p>
<blockquote>
<div><p></p>
</div></blockquote>
<p>ma
th
bb
{E
}_
{rh
<a href="#id16"><span class="problematic" id="id17">o_</span></a>
{X
}}</p>
<blockquote>
<div><p></p>
</div></blockquote>
<p>bi
gl
[ma
th
ca
l{
O}</p>
<blockquote>
<div><p></p>
</div></blockquote>
<p>bi
gl
]
=
f
ra
c{
1}
{n
}su
<a href="#id18"><span class="problematic" id="id19">m_</span></a>
{i</p>
<blockquote>
<div><p>=
0</p>
</div></blockquote>
<p>}^
n
m
at
hc
al
{O
}(
<a href="#id20"><span class="problematic" id="id21">x_</span></a>
i)</p>
</td>
</tr>
<tr class="row-odd"><td><p>He
nc
e
we
ca
n
co
mp
ut
e
ex
pe
ct
ed
ou
tc
om
es
by
pl
ug
gi
ng
in
th
e
da
ta
.</p></td>
</tr>
</tbody>
</table>
<p>Throughout, we’ll use very simple synthetic data, one generated from a
unit gaussian, one generated from a standard exponential distribution</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sample_size = 30
# averages of large subpopulations
normal_data = np.random.normal(0, 1, sample_size)
# skewed data, exponential distribution
exp_data = np.random.exponential(1, sample_size)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(1, 2, figsize=(15, 5))
bins = 50
ax[0].hist(normal_data, bins=bins, density=True)
ax[0].set(
    xlim=(-4, 4),
    xlabel=&quot;h&quot;,
    ylabel=&quot;number of occurences in sample&quot;,
    title=&quot;Empirical Distribution of a Random Sample of Standard Normal Distribution&quot;,
)
ax[1].hist(exp_data, bins=bins, density=True)
ax[1].set(
    xlim=(0, 5),
    title=&quot;Empirical Distribution of a Sample of Standard Exponential Distribution&quot;,
);
</pre></div>
</div>
<img alt="learning/statistical_inference/intro_to_bootstrap_methods_files/intro_to_bootstrap_methods_13_0.png" src="learning/statistical_inference/intro_to_bootstrap_methods_files/intro_to_bootstrap_methods_13_0.png" />
<div class="section" id="bootstrap-samples">
<h2>Bootstrap Samples<a class="headerlink" href="#bootstrap-samples" title="Permalink to this headline">¶</a></h2>
<p>The bootstrap numerically approximates the uncertainty in a test
statistic due to the sampling process.</p>
<p>A <strong>bootstrap sample of :math:`X`</strong> is a sample (with the same size as
<span class="math notranslate nohighlight">\(X\)</span>) drawn with replacement from <span class="math notranslate nohighlight">\(X\)</span>.</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(X\)</span> was drawn from a probability distribution, <span class="math notranslate nohighlight">\(\rho\)</span>,
a bootstrap sample models <span class="math notranslate nohighlight">\(N\)</span> i.i.d. random variables.</p></li>
</ul>
<p>The following code makes this explicit.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def btstrp_samples(N_btstrp, data):
    &quot;&quot;&quot;
    Creates a bunch of bootstrap samples from the data

    Input:
    ------
    data = sample data

    N_btstrp = number of bootstrap samples

    Output:
    -------
    btstrp_samples = 2 dimensional numpy array.
                     First axis indexes which bootstrap sample.
                     Second axis is the bootstrap sample.
    &quot;&quot;&quot;
    sample_size = data.shape[0]
    # drawing with replacement = uniformly randomly generating indices
    indices = np.random.randint(0, sample_size, size=(N_btstrp, sample_size))
    btstrp_samples = data[indices]
    return btstrp_samples
</pre></div>
</div>
<p>Let’s generate <span class="math notranslate nohighlight">\(10^3\)</span> bootstrap samples from each:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>N_btstrp = 10 ** 4
normal_btstrp = btstrp_samples(N_btstrp, normal_data)
exp_btstrp = btstrp_samples(N_btstrp, exp_data)

print(&quot;Example data:\n&quot;, normal_data[0:5])
print(&quot;5 bootstrap samples of the above:\n&quot;, btstrp_samples(6, normal_data[0:5]))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="n">data</span><span class="p">:</span>
 <span class="p">[</span> <span class="mf">1.80731217</span> <span class="o">-</span><span class="mf">3.10404138</span> <span class="o">-</span><span class="mf">0.32807689</span> <span class="o">-</span><span class="mf">0.25174053</span> <span class="o">-</span><span class="mf">0.69932765</span><span class="p">]</span>
<span class="mi">5</span> <span class="n">bootstrap</span> <span class="n">samples</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span><span class="p">:</span>
 <span class="p">[[</span><span class="o">-</span><span class="mf">0.69932765</span> <span class="o">-</span><span class="mf">0.32807689</span> <span class="o">-</span><span class="mf">0.69932765</span> <span class="o">-</span><span class="mf">3.10404138</span>  <span class="mf">1.80731217</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.25174053</span>  <span class="mf">1.80731217</span> <span class="o">-</span><span class="mf">0.32807689</span> <span class="o">-</span><span class="mf">3.10404138</span> <span class="o">-</span><span class="mf">0.69932765</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.69932765</span> <span class="o">-</span><span class="mf">0.69932765</span> <span class="o">-</span><span class="mf">0.25174053</span> <span class="o">-</span><span class="mf">0.69932765</span> <span class="o">-</span><span class="mf">0.32807689</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.25174053</span>  <span class="mf">1.80731217</span> <span class="o">-</span><span class="mf">0.69932765</span>  <span class="mf">1.80731217</span> <span class="o">-</span><span class="mf">0.25174053</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.69932765</span> <span class="o">-</span><span class="mf">0.25174053</span> <span class="o">-</span><span class="mf">0.69932765</span> <span class="o">-</span><span class="mf">0.25174053</span> <span class="o">-</span><span class="mf">3.10404138</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">3.10404138</span> <span class="o">-</span><span class="mf">0.32807689</span> <span class="o">-</span><span class="mf">0.32807689</span> <span class="o">-</span><span class="mf">0.69932765</span>  <span class="mf">1.80731217</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="test-statistics">
<h2>Test Statistics<a class="headerlink" href="#test-statistics" title="Permalink to this headline">¶</a></h2>
<p>Recall that a test statistics inputs a sample of size <span class="math notranslate nohighlight">\(n\)</span>,
<span class="math notranslate nohighlight">\(X = (x_1, \ldots x_n)\)</span> and outputs a number <span class="math notranslate nohighlight">\(T(X)\)</span>.</p>
<p>For concreteness, we’ll only consider the mean and the median.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># mean
normal_mean = normal_data.mean()
exp_mean = exp_data.mean()

# median
normal_median = np.median(normal_data)
exp_median = np.median(exp_data)

print(&quot;Normal sample mean:\n&quot;, normal_mean)
print(&quot;Exponential sample mean:\n&quot;, exp_mean)
print(&quot;Normal sample median:\n&quot;, normal_median)
print(&quot;Exponential sample median:\n&quot;, exp_median)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Normal</span> <span class="n">sample</span> <span class="n">mean</span><span class="p">:</span>
 <span class="o">-</span><span class="mf">0.2315122547402513</span>
<span class="n">Exponential</span> <span class="n">sample</span> <span class="n">mean</span><span class="p">:</span>
 <span class="mf">0.8636004200371779</span>
<span class="n">Normal</span> <span class="n">sample</span> <span class="n">median</span><span class="p">:</span>
 <span class="o">-</span><span class="mf">0.31037910662722035</span>
<span class="n">Exponential</span> <span class="n">sample</span> <span class="n">median</span><span class="p">:</span>
 <span class="mf">0.5896672763389601</span>
</pre></div>
</div>
<p>The mean of the standard exponential distribution is 1, while the median
<span class="math notranslate nohighlight">\(\simeq .7\)</span>.</p>
<p>Note that it’s really hard to say anything analytic about median,
despite how useful it is for understanding data with outliers.</p>
<p>I would argue that this is really where the bootstrap shines: test
statistics that are difficult to manipulate algebraically.</p>
</div>
<div class="section" id="distributions-of-outcomes">
<h2>Distributions of Outcomes<a class="headerlink" href="#distributions-of-outcomes" title="Permalink to this headline">¶</a></h2>
<p>We now compute the test statistic on each of the bootstrap samples. This
generates a distribution of outcomes, which we can manipulate with the
same tools as any other probability distribution.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Compute the means of each bootstrap sample
normal_btstrp_means = normal_btstrp.mean(axis=1)
exp_btstrp_means = exp_btstrp.mean(axis=1)

# Compute the medians of each bootstrap sample
normal_btstrp_medians = np.median(normal_btstrp, axis=1)
exp_btstrp_medians = np.median(exp_btstrp, axis=1)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(2, 2, figsize=(10, 10))

ax[0, 0].hist(normal_btstrp_means, density=True, bins=100)
ax[0, 0].set(xlim=(-2, 2), title=&quot;Normal Bootstrap Means&quot;)
ax[0, 1].hist(exp_btstrp_means, density=True, bins=100)
ax[0, 1].set(xlim=(-2, 2), title=&quot;Exponential Bootstrap Means&quot;)
ax[1, 0].hist(normal_btstrp_medians, density=True, bins=100)
ax[1, 0].set(xlim=(-2, 2), title=&quot;Normal Bootstrap Medians&quot;)
ax[1, 1].hist(exp_btstrp_medians, density=True, bins=50)
ax[1, 1].set(xlim=(-2, 2), title=&quot;Exponential Bootstrap Medians&quot;);
</pre></div>
</div>
<img alt="learning/statistical_inference/intro_to_bootstrap_methods_files/intro_to_bootstrap_methods_24_0.png" src="learning/statistical_inference/intro_to_bootstrap_methods_files/intro_to_bootstrap_methods_24_0.png" />
<p>Note that the Central Limit theorem suggests the top right distribution
should be normal. In particular, it should have zero skew. This is not
always the case.</p>
<p>As the exponential distrubution is skew, the sample size needs to be
especially large for normal-distribution based (z, t) confidence
intervals to be valid. This is one reason why bootstrap is “better for
small samples”tg</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stats.skew(exp_btstrp_means)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.2384778842666818</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(
    &quot;The mode of the bootstrap simulation of the mediand is:\n&quot;,
    stats.mode(np.round(exp_btstrp_medians, decimals=2))[0]
)
print(&quot;The &#39;true&#39; median is:\n&quot;, np.log(2))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">mode</span> <span class="n">of</span> <span class="n">the</span> <span class="n">bootstrap</span> <span class="n">simulation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">mediand</span> <span class="ow">is</span><span class="p">:</span>
 <span class="p">[</span><span class="mf">0.59</span><span class="p">]</span>
<span class="n">The</span> <span class="s1">&#39;true&#39;</span> <span class="n">median</span> <span class="ow">is</span><span class="p">:</span>
 <span class="mf">0.6931471805599453</span>
</pre></div>
</div>
<p>Note that the normality of the distributions in the top row are a
consequence of the CLT applied to the empirical distribution.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(exp_btstrp_means.std() * np.sqrt(30))
print(exp_btstrp_means.mean())
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.7481288363957243</span>
<span class="mf">0.864384638337859</span>
</pre></div>
</div>
</div>
<div class="section" id="confidence-intervals">
<h2>Confidence Intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this headline">¶</a></h2>
<p>Recall that given a probability distribution on <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>, the
(two sided) <span class="math notranslate nohighlight">\(100(1-\alpha)\)</span>% confidence interval is a range of
values:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}  [a_\alpha, b_\alpha]\\where one\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\mathrm{P}(x \leq a_\alpha) = \frac{\alpha}{2} \\
\mathrm{P}(x \geq b_\alpha) = \frac{\alpha}{2}\end{split}\]</div>
<p>i.e. it’s a range of values that covers <span class="math notranslate nohighlight">\(100(1-\alpha)\)</span>% of the
“population”.</p>
</div>
<div class="section" id="the-quantile-and-basic-bootstrap-ci">
<h2>The Quantile and Basic Bootstrap CI<a class="headerlink" href="#the-quantile-and-basic-bootstrap-ci" title="Permalink to this headline">¶</a></h2>
<p>There are a plethora of CIs we can generate from this bootstrapped
distribution. Here are the three most basic ones:</p>
<ol class="arabic simple">
<li><p>“Quantile/Percentile CI”: literally the CI of the distribution of the
test statistic.</p>
<ul class="simple">
<li><p>This makes no reference to the value of the test statistic on the
original data.</p></li>
<li><p>Accuracy is “first-order” (scales with <span class="math notranslate nohighlight">\(n^{-\frac{1}{2}}\)</span>)</p></li>
</ul>
</li>
<li><p>“Basic Bootstrap CI”: This is a CI generated by looking at the
deviations from the test statistic evaluated on the original data.</p>
<ul class="simple">
<li><p>Accuracy is “first-order” (scales with <span class="math notranslate nohighlight">\(n^{-\frac{1}{2}}\)</span>)</p></li>
<li><p>Corrects for bias</p></li>
<li><p>Better theoretical justification than the percentile CI</p></li>
</ul>
</li>
<li><p>“Bias-Corrected and Accelerated (<span class="math notranslate nohighlight">\(\mathrm{BC}_a\)</span>)”: this is
more involved to explain, but is in various senses “better” than the
above two</p>
<ul class="simple">
<li><p>Accuracy is “second-order” (scales with <span class="math notranslate nohighlight">\(n^{-1}\)</span>), making it
more accurate than the basic</p></li>
<li><p>Corrects for bias and skew in data</p></li>
<li><p>Is invariant of our chose parameterziation (e.g. our chosen units)</p></li>
</ul>
</li>
</ol>
<p>In general, one should go with the <span class="math notranslate nohighlight">\(\mathrm{BC}_a\)</span> confidence
intervals. <em>Many thanks to ChuChu Cheng for bringing this to my
attention</em></p>
<p>Below is how one would code the first two by hand:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def quantile_CI(X_btstrp, alpha):
    &quot;&quot;&quot;
    Finds a confidence interval level with significance alpha
    &quot;&quot;&quot;
    a = np.quantile(X_btstrp, alpha / 2)
    b = np.quantile(X_btstrp, 1 - alpha / 2)
    return np.array([a, b])

def bsc_btstrp_CI(X_btstrp, alpha, estimate):
    # compute deviations from the original estimate
    deltaX = estimate - X_btstrp
    # add them to the original estimate
    X_deltaX = estimate + deltaX # 2 * estimate - X_btstrp
    # compute the ordinary CI for this new distribution
    btstrp_CI = quantile_CI(X_deltaX, alpha)
    return btstrp_CI
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(&quot;The 95% quantile CI for the exponential distrubition is:\n&quot;, quantile_CI(normal_btstrp_means, 0.05))
print(&quot;The 95% basis bootstrap CI for the exponential distrubition is:\n&quot;, bsc_btstrp_CI(normal_btstrp_means, 0.05, normal_mean))
print(&quot;While the z-test say it is: \n&quot;,
      [normal_mean - normal_data.std() * 1.96 /np.sqrt(normal_data.shape[0]),
    normal_mean + normal_data.std() * 1.96 /np.sqrt(normal_data.shape[0])])
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="mi">95</span><span class="o">%</span> <span class="n">quantile</span> <span class="n">CI</span> <span class="k">for</span> <span class="n">the</span> <span class="n">exponential</span> <span class="n">distrubition</span> <span class="ow">is</span><span class="p">:</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.42271372</span>  <span class="mf">0.24848376</span><span class="p">]</span>
<span class="n">The</span> <span class="mi">95</span><span class="o">%</span> <span class="n">basis</span> <span class="n">bootstrap</span> <span class="n">CI</span> <span class="k">for</span> <span class="n">the</span> <span class="n">exponential</span> <span class="n">distrubition</span> <span class="ow">is</span><span class="p">:</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.42399016</span>  <span class="mf">0.24720733</span><span class="p">]</span>
<span class="n">While</span> <span class="n">the</span> <span class="n">z</span><span class="o">-</span><span class="n">test</span> <span class="n">say</span> <span class="n">it</span> <span class="ow">is</span><span class="p">:</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.4247023051310682</span><span class="p">,</span> <span class="mf">0.24919591012350764</span><span class="p">]</span>
</pre></div>
</div>
<p>Math tells us that (for large <span class="math notranslate nohighlight">\(n\)</span>) the probability that the test
statistic lies in the <span class="math notranslate nohighlight">\(100(1- \alpha)\)</span>% basic bootstrap interval
is indeed <span class="math notranslate nohighlight">\(1-\alpha\)</span></p>
<div class="section" id="bootstrap-intervals-with-arch">
<h3>Bootstrap Intervals with Arch<a class="headerlink" href="#bootstrap-intervals-with-arch" title="Permalink to this headline">¶</a></h3>
<p>Fortunately, there’s a really nice Python package (Arch) which computes
these plethora of bootstrap intervals for you. We can do this with the
<code class="docutils literal notranslate"><span class="pre">IIDBootstrap</span></code> object.</p>
<p>Documentation may be found at:</p>
<p><a class="reference external" href="https://arch.readthedocs.io/en/latest/bootstrap/confidence-intervals.html">https://arch.readthedocs.io/en/latest/bootstrap/confidence-intervals.html</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from arch.bootstrap import IIDBootstrap
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>bs = IIDBootstrap(exp_data)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>test_statistic = np.mean
N = 10 ** 3
pci = bs.conf_int(test_statistic, reps=N, method=&quot;percentile&quot;)
bci = bs.conf_int(test_statistic, reps=N, method=&quot;basic&quot;)
bcaci = bs.conf_int(test_statistic, reps=N, method=&quot;bca&quot;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.61218566</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.11261196</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(&quot;Percentile/Quantile CI:\n&quot;, np.round(pci[:, 0], decimals=2))
print(&quot;Basic CI:\n&quot;, np.round(bci[:, 0], decimals=2))
print(&quot;Bias-Corrected and Accelerated:\n&quot;, np.round(bci[:, 0], decimals=2))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Percentile</span><span class="o">/</span><span class="n">Quantile</span> <span class="n">CI</span><span class="p">:</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.61</span>  <span class="mf">0.11</span><span class="p">]</span>
<span class="n">Basic</span> <span class="n">CI</span><span class="p">:</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.57</span>  <span class="mf">0.13</span><span class="p">]</span>
<span class="n">Bias</span><span class="o">-</span><span class="n">Corrected</span> <span class="ow">and</span> <span class="n">Accelerated</span><span class="p">:</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.57</span>  <span class="mf">0.13</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bootstrap-a-b-testing">
<h1>Bootstrap A/B Testing<a class="headerlink" href="#bootstrap-a-b-testing" title="Permalink to this headline">¶</a></h1>
<p>Scheme I:</p>
<ul class="simple">
<li><p>Choose a test statistic and a null hypothesis</p></li>
<li><p>Compute the test statistic for the null</p></li>
<li><p>Use data to compute the basic bootstrap confidence interval</p></li>
<li><p>If the null’s test statistic is outside of this CI, reject the null.</p>
<ul>
<li><p>Alternatively, you can compare the CI generated by the null
“parametric bootstrap”</p></li>
</ul>
</li>
</ul>
<p>Questions:</p>
<ul class="simple">
<li><p>What’s the acceptance region of this test?</p></li>
<li><p>What’s the significance level of this test?</p></li>
<li><p>What’s the power of this test?</p></li>
<li><p>How would you compute these ahead of time?</p></li>
</ul>
<div class="section" id="conclusion">
<h2>Conclusion:<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The bootstrap simulates the randomness coming from the sampling
process.</p></li>
<li><p>Is especially useful for test statistics that don’t admit an analytic
description</p></li>
<li><p>Also can be used when the distribution goes towards a nice form too
slowly</p>
<ul>
<li><p>“small sample”</p></li>
</ul>
</li>
<li><p>It’s not a cure-all for small sample sizes</p></li>
<li><p>Can also be used to “protect against model misspecification” when
parametric methods (MLEs) are used.</p></li>
</ul>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Jeremy Mann's Writing</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../learning_main_page.html">Learning</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../machine_learning/machine_learning_main_page.html">Machine Learning</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="statistical_inference_main_page.html">Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statistical_learning/statistical_learning_main_page.html">Statistical Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_science/data_science_main_page.html">Data Science</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../pure_math/pure_math_main_page.html">Pure Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/physics_main_page.html">Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../longevity/longevity_main_page.html">Longevity</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../random/random_main_page.html">Random Writing</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../learning_main_page.html">Learning</a><ul>
  <li><a href="statistical_inference_main_page.html">Statistical Inference</a><ul>
      <li>Previous: <a href="statistical_inference_main_page.html" title="previous chapter">Statistical Inference</a></li>
      <li>Next: <a href="../statistical_learning/statistical_learning_main_page.html" title="next chapter">Statistical Learning</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Jeremy Mann.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/learning/statistical_inference/introduction_to_bootstrap_methods.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>